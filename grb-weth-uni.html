<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta2/css/all.min.css" integrity="sha512-YWzhKL2whUzgiheMoBFwW8CKV4qpHQAEuvilg9FAn5VJUDwKZZxkJNuGM4XkWuk94WCrrwslk8yWNGmY1EduTA==" crossorigin="anonymous" referrerpolicy="no-referrer"
    />
    <link href="./assets/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.14.0-beta2/css/bootstrap-select.min.css" integrity="sha512-mR/b5Y7FRsKqrYZou7uysnOdCIJib/7r5QeJMFvLNHNhtye3xJp1TdJVPLtetkukFn227nKpXD9OjUc09lx97Q==" crossorigin="anonymous"
        referrerpolicy="no-referrer" />
    <link rel="shortcut icon" href="./assets/images/garbi_favicon.png" type="image/x-icon">
    <link href="./assets/css/style.css" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/big-integer/1.6.48/BigInteger.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>
    <script src="./assets/js/web3.min.js"></script>
    <script src="./assets/js/trustwallet.js"></script>
    <script src="./js/contract/arbitrum/abi.js"></script>
    <script src="./js/contract/arbitrum/config.js"></script>
    <script src="./js/data/store.js"></script>
    <script src="./js/contract/arbitrum/core.js"></script>
    <script src="./js/contract/arbitrum/base.contract.js"></script>
    <script src="./js/contract/arbitrum/data.js"></script>
    <script src="./js/contract/arbitrum/garbi.farm.contract.js"></script>

    <title>GRB-WETH Uniswap V3 Vault - Garbi Protocol</title>
    <style id="svelte-166mr51-style">
        ul.svelte-166mr51 {
            display: flex;
            flex-flow: column nowrap;
            position: fixed;
            font-size: 16px;
            padding: 0 0.75em;
            margin: 0;
            list-style-type: none;
            width: 20em;
            bottom: 0;
            right: 0;
            font-family: 'Helvetica Neue';
            max-height: 100vh;
            overflow-y: scroll;
            overflow-x: hidden;
            color: #4a4a4a;
            background: transparent;
            scrollbar-width: none;
            box-sizing: border-box;
            height: 100vh;
            pointer-events: none;
            z-index: 99999999
        }
        @media only screen and (max-width: 450px) {
            ul.svelte-166mr51 {
                width: 100%
            }
        }
        
        .bn-notify-custom.bn-notify-dark-mode {
            background: #283944;
            color: #ffffff;
            background: rgba(40, 57, 68, 0.9)
        }
        
        .bn-notify-clickable:hover {
            cursor: pointer
        }
        
        .svelte-166mr51::-webkit-scrollbar {
            display: none
        }
        
        li.svelte-166mr51 {
            position: relative;
            display: flex;
            padding: 0.75em;
            font-size: 0.889em;
            font-family: inherit;
            border-radius: 10px;
            background: #ffffff;
            box-shadow: 0px 2px 10px rgba(0, 0, 0, 0.1);
            color: inherit;
            transition: background 300ms ease-in-out, color 300ms ease-in-out;
            pointer-events: all;
            background: #ffffff;
            backdrop-filter: blur(5px);
            background: rgba(255, 255, 255, 0.9)
        }
        
        div.svelte-166mr51 {
            position: absolute;
            top: 0.75em;
            right: 0.75em;
            font-size: inherit;
            font-family: inherit
        }
    </style>
    <style id="svelte-7rn0pv-style">
        div.svelte-7rn0pv {
            height: 100%;
            font-size: inherit;
            font-family: inherit;
            width: 1.5em
        }
    </style>
    <style id="svelte-5f7pqk-style">
        div.svelte-5f7pqk {
            display: flex;
            flex-flow: column nowrap;
            justify-content: center;
            font-size: inherit;
            font-family: inherit;
            margin-left: 0.75em;
            width: 90%
        }
        
        p.svelte-5f7pqk {
            display: flex;
            align-items: center;
            margin: 0.5em 0 0 0;
            opacity: 0.7;
            font-size: 0.889em;
            line-height: 1.15;
            font-family: inherit
        }
        
        span.svelte-5f7pqk {
            font-family: inherit;
            display: flex;
            align-items: center
        }
    </style>
    <style id="svelte-12gqi36-style">
        p.svelte-12gqi36 {
            margin: 0;
            font-family: inherit;
            font-size: inherit
        }
    </style>
    <style id="svelte-1ociadw-style">
        svg.svelte-1ociadw {
            margin: 0 0.25em 0 0.5em
        }
    </style>
</head>

<body>
    <div class="wrapper">
        <header class="header" id="header">
            <div class="alert-banner" style="background: rgb(45, 66, 252)">
                <div class="message">Please note that Garbi Protocol is currently only supported on the Arbitrum One network. To use Garbi Protocol, switch to a network that supports it.</div>
            </div>
            <nav class="navbar navbar-expand-lg">
                <div class="container container-1">
                    <div class="row flex-grow-1 align-items-center">
                        <div class="col-6 col-lg-2">
                            <div class="d-flex align-items-center">
                                <button class="navbar-toggler mr-3" type="button" data-bs-toggle="collapse" data-bs-target="#navbar-header">
                                    <i class="fas fa-bars"></i>
                                </button>
                                <div class="logo" onclick="window.location='index.html'">
                                    <img src="./assets/images/garbi.png" />
                                </div>
                            </div>
                        </div>
                        <div class="col-6 col-lg-2 order-lg-3">
                            <div class="d-flex align-items-center justify-content-end">
                                <span class="wrap-user-acct">0x000</span>
                                <a href="#" class="header__btn-connect btn-connect-wallet wrap-btn-connect">Connect your wallet</a>
                                <span class="dropMenu">
                                    <button type="button" class="header__btn-swap ms-3 ctmenu-item"><i class="fas fa-ellipsis-h"></i></button>
                                    <div class="ctmenu-sub  swap-box">
                                        <a class="f-roboto f-400" href="dashboard.html">Dashboard</a>
                                    </div>
                                </span>
                            </div>
                        </div>
                        <div class="col-lg-8">
                            <div class="collapse navbar-collapse" id="navbar-header">
                                <ul class="navbar-nav menu-header-swap mx-auto mb-2 mb-lg-0 align-items-lg-center">
                                        <li>
                                            <a class="nav-link" href="swap.html">Swap</a>
                                        </li>
                                        <li class="nav-item">
                                            <a class="nav-link" href="earn.html">Earn</a>
                                        </li>
                                        <li class="nav-item">
                                            <a class="nav-link" href="equity-cert-exchange.html">GEC Exchange</a>
                                        </li>
                                        <li class="nav-item">
                                            <a class="nav-link" href="vest.html">Vest veGRB to GRB</a>
                                        </li>
                                        <li class="nav-item dropdown">
                                          <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownMore" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                                            GRB-WETH Liquidity
                                          </a>
                                            <ul class="dropdown-menu" aria-labelledby="navbarDropdownMore">
                                                <li>
                                                    <a class="dropdown-item" href="deposit.html">Deposit</a>
                                                </li>
                                                <li>
                                                    <a class="dropdown-item" href="withdraw.html">Withdraw</a>
                                                </li>
                                            </ul>                                
                                        </li>
                                        <li class="nav-item">
                                            <a class="nav-link" href="v1/index.html">V1</a>
                                        </li>
                                        <li class="nav-item">
                                            <a class="nav-link" href="no-loss-lottery.html">Lottery</a>
                                        </li>
                                        <!-- <li class="nav-item">
                                            <a class="nav-link" href="deposit.html">Deposit</a>
                                        </li>
                                        <li class="nav-item">
                                            <a class="nav-link" href="withdraw.html">Withdraw</a>
                                        </li> -->
                                        
                                    </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </nav>
        </header>
        <main class="page__swap grb-farm-2">
            <section class="blog__container">
                <div class="masthead">
                    <div class="masthead__values header-display ">
                        <div class="masthead__balance-value">
                            <h4 class="L0 heading heading--emphasized">
                                <span class="toggle-icon-wrapper">
                                    <div class="icon icon--centered undefined">
                                        <div class="token-1">GRB</div><div class="token-2">ETH</div>
                                    </div>
                                </span>
                                <p><span class="gec-price">GRB / ETH</span></p>
                                <div class="" style="margin-left: 10px;">
                                    <div class="percent-volume"><span>0.3%</span></div>
                                </div>
                                <div class="notice-range">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <circle cx="12" cy="12" r="10"></circle>
                                        <line x1="12" y1="8" x2="12" y2="12"></line>
                                        <line x1="12" y1="16" x2="12.01" y2="16"></line>
                                    </svg>
                                    &nbsp;
                                    <div class="">Out of range</div>
                                </div>
                            </h4>
                        </div>
                    </div>
                    <div class="masthead__action-buttons">
                        <div class="masthead__action-buttons">
                            <button class="button button--large button--buy button-deposit-nft" data-bs-toggle="modal" data-bs-target="#token-increase">
                                <label class="label">Deposit NFT-LP, Earn veGRB</label>
                            </button>
                            <button class="button button--large button--sell button-withdraw button-disabled">
                                <label class="label">Exit Vault</label>
                            </button>
                            <!-- Modal -->
                            <div class="modal fade" id="token-increase" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                              <div class="modal-dialog modal-dialog-centered modal-sm">
                                <div class="modal-content">
                                  <div class="modal-header">
                                    <h5 class="modal-title" id="exampleModalLabel">Enable USD coin</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">X</button>
                                  </div>
                                  <div class="modal-body">
                                    <div class="img">
                                        <img src="" class="image-token" >
                                    </div>
                                    <div class="description">
                                        <p>To supply USDC to Compound Protocol, you need to enable first. This is one-time approval.</p>
                                    </div>
                                  </div>
                                  <div class="modal-footer">
                                    <button type="button" class="btn btn-primary btn-approve">Enable USDC</button>
                                    <button type="button" class="btn btn-primary btn-deposit">Deposit USDC</button>
                                  </div>
                                </div>
                              </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-lg-4 col-sm-12">
                        <div class="image">
                            <img src="" class="image-token" >
                        </div>
                    </div>
                    <div class="col-lg-8 col-sm-12">
                        <article class="liquidity-form garbi__box-1 p-3 mb-3">
                            <div class="d-flex align-items-center justify-content-between mb-12">
                                <div class="f-700">
                                    <span>Liquidity</span>
                                </div>                             
                            </div>
                            <div class="volume">$<span class="liquidity-volume">0</span></div>
                            <div class="form-item swap__form-item">
                                <div class="row">
                                    <div class="col-6">
                                        <div class="" style="margin-bottom: 12px;">                                         
                                            <div class="" style="display: flex;align-items: center;">
                                                <div class="logo-token" style="margin-right: 0.5rem;">
                                                    <img class="" src="../assets/images/grb_token.png">
                                                </div>
                                                <div class="">GRB</div>
                                            </div>
                                        </div>
                                        <div class="" style="display: flex;align-items: center;">
                                            <div class="logo-token" style="margin-right: 0.5rem;">
                                                <img class="" src="../assets/images/eth.png">
                                            </div>                                        
                                            <span class="">ETH</span>
                                        </div>
                                    </div>
                                    <div class="col-6" style=" text-align: right;position: relative;">
                                        <div class="text-end" style="display: flex;justify-content: right;align-items:center;margin-bottom: 12px;">                                         
                                            <span class="user-token-1-amount">0</span>
                                        </div>
                                        <div class="text-end" style="display: flex;justify-content: right;align-items:center;">                                         
                                            <span class="user-token-2-amount">0</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </article>
                        <article class="liquidity-form garbi__box-1 p-3 mb-3">
                            <div class="d-flex align-items-center justify-content-between mb-12">
                                <div class="f-700">
                                    <span>Earned</span>
                                </div>
                                <button width="fit-content" class="button button--large button--buy harvest-button">
                                    <label class="label">Harvest</label>
                                </button>                          
                            </div>
                            <div class="volume">$<span class="earn-volume">0.0</span></div>
                            <div class="form-item swap__form-item">
                                <div class="row">
                                    <div class="col-6">
                                        <div class="">                                         
                                            <div class="" style="display: flex;align-items: center;margin-bottom: 12px;">
                                                <div class="logo-token" style="margin-right: 0.5rem;">
                                                    <img class="" src="../assets/images/grb_token.png">
                                                </div>
                                                <div class="">GRB</div>
                                            </div>
                                        </div>
                                        <div class="" style="display: flex;align-items: center;">
                                            <div class="logo-token" style="margin-right: 0.5rem;">
                                                <div class="token-1" style="--size: 40px;">%</div>
                                            </div>                                   
                                            <span class="">APR</span>
                                        </div>
                                    </div>
                                    <div class="col-6" style=" text-align: right;position: relative;">
                                        <div class="text-end" style="display: flex;justify-content: right;align-items:center;margin-bottom: 12px;">                                         
                                            <span class="user-earn-token">0</span>
                                        </div>
                                        <div class="text-end" style="display: flex;justify-content: right;align-items:center;">                                         
                                            <span class="">100%</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </article>
                    </div>
                </div>
                
                <article class="price-range swap__main garbi__box-1 p-3 mb-3">
                    <div class="d-flex align-items-center justify-content-between mb-14">
                        <div class="f-700">
                            <span>Vault Information</span>
                        </div>
                    </div>
                    <div class="d-flex align-items-center justify-content-between mb-14">
                        <div class="title">
                            <span>Total Asset Value Secured: </span> $100,000
                        </div>
                    </div>
                    <div class="d-flex align-items-center justify-content-between mb-14">
                        <div class="title">
                            <span>Price range</span>
                            <div class="notice-range">
                                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <circle cx="12" cy="12" r="10"></circle>
                                    <line x1="12" y1="8" x2="12" y2="12"></line>
                                    <line x1="12" y1="16" x2="12.01" y2="16"></line>
                                </svg>
                                &nbsp;
                                <div class="">Out of range</div>
                            </div>
                        </div>
                    </div>
                    <div class="min-and-max">
                        <div class="row">
                            <div class="col-lg-5">
                                <div class="form-item swap__form-item min-price">
                                    <div class="">
                                        <span class="">Min price</span>
                                        <div class="price">0.00028 ($0.5)</div>
                                        <span class="description"> ETH per GRB</span>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-2" style="display: flex;align-items: center;justify-content: center;font-size: 30px;">
                                <span class="">⟷</span>
                            </div>
                            <div class="col-lg-5">
                                <div class="form-item swap__form-item max-price">
                                    <div class="">
                                        <span class="">Max price</span>
                                        <div class="price">0.0014 ($2.5)</div>
                                        <span class="description"> ETH per GRB</span>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-12">
                                 <div class="form-item swap__form-item current-price">
                                    <div class="">
                                        <span class="">Current price</span>
                                        <div class="price">0.49859</div>
                                        <span class="description"> ETH per GRB</span>
                                    </div>
                                </div>
                            </div>
                        </div>        
                    </div>
                </article>

            </section>
        </main>

        <footer class="footer">
                <nav class="navbar navbar-expand-lg">
                    <div class="container container-1">
                        <div class="row flex-grow-1 align-items-center">
                            <div class="col-lg-4">
                                <div class="d-flex align-items-center justify-content-between">
                                    <div>© 2023 Garbi Protocol</div>
                                    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar-footer">
                                        <i class="fas fa-bars"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="col-lg-8">
                                <div class="collapse navbar-collapse" id="navbar-footer">
                                    <ul class="navbar-nav menu-footer ms-auto mb-2 mb-lg-0">
                                        <li class="nav-item">
                                            <a class="nav-link" href="risks.html" class="">Risks</a>
                                        </li>
                                        <li class="nav-item">
                                            <a class="nav-link" target="_blank" href="https://garbi-protocol.gitbook.io/docs/">Docs</a>
                                        </li>
                                        <li class="nav-item">
                                            <a class="nav-link" target="_blank" href="https://twitter.com/garbi_protocol/" rel="noopener noreferrer">#Twitter</a>
                                        </li>
                                        <li class="nav-item">
                                            <a class="nav-link" target="_blank" href="https://t.me/garbiprotocol" rel="noopener noreferrer">@Telegram</a>
                                        </li>
                                        <li class="nav-item">
                                            <a class="nav-link" target="_blank" href="https://github.com/garbiprotocol">git@</a>
                                        </li>
                                        <li class="nav-item">
                                            <a class="nav-link" href="#">Version 2.0.0</a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </nav>
            </footer>
    </div>
    <ul id="confirm-popup" class="bn-notify-custom bn-notify-notifications svelte-166mr51" style="display:none;top: 0; justify-content: unset;">
        <li style="margin: 0.75rem 0px 0px;" class="bn-notify-custom bn-notify-notification svelte-166mr51">
            <div class="bn-notify-custom bn-notify-notification-info svelte-5f7pqk">
                <p class="bn-notify-custom bn-notify-notification-info-message svelte-12gqi36">Your <a href="" target="_blank" class="transaction-hash">transaction</a> is sent to the Blockchain.</p>
            </div>
            <div class="bn-notify-custom bn-notify-notification-close svelte-166mr51" onclick="$('#confirm-popup').hide()">
                <div class="bn-notify-custom bn-notify-notification-close-icon svelte-r8gx3p">
                    <svg height="8" viewBox="0 0 12 12" width="8" xmlns="http://www.w3.org/2000/svg">
                        <g fill="none" stroke="#9B9B9B" stroke-linecap="square" stroke-width="2" transform="translate(2 2)" style="transition: stroke 150ms ease-in-out 0s;">
                        <path d="m.1.1 7.82304289 7.82304289"></path>
                        <path d="m.1.1 7.82304289 7.82304289" transform="matrix(-1 0 0 1 8 0)"></path>
                        </g>
                        </svg>
                </div>
            </div>
        </li>
    </ul>
    <ul id="success-confirm-popup" class="bn-notify-custom bn-notify-notifications svelte-166mr51" style="display:none; top: 0; justify-content: unset;">
        <li style="margin: 0.75rem 0px 0px;" class="bn-notify-custom bn-notify-notification svelte-166mr51">
            <div class="bn-notify-custom bn-notify-notification-info svelte-5f7pqk">
                <p class="bn-notify-custom bn-notify-notification-info-message svelte-12gqi36">Your <a href="" target="_blank" class="transaction-hash">transaction</a> is confirmed.</p>
            </div>
            <div class="bn-notify-custom bn-notify-notification-close svelte-166mr51" onclick="$('#success-confirm-popup').hide()">
                <div class="bn-notify-custom bn-notify-notification-close-icon svelte-r8gx3p">
                    <svg height="8" viewBox="0 0 12 12" width="8" xmlns="http://www.w3.org/2000/svg">
                        <g fill="none" stroke="#9B9B9B" stroke-linecap="square" stroke-width="2" transform="translate(2 2)" style="transition: stroke 150ms ease-in-out 0s;">
                        <path d="m.1.1 7.82304289 7.82304289"></path>
                        <path d="m.1.1 7.82304289 7.82304289" transform="matrix(-1 0 0 1 8 0)"></path>
                        </g>
                        </svg>
                </div>
            </div>
        </li>
    </ul>
    <script src="./assets/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.14.0-beta2/js/bootstrap-select.min.js" integrity="sha512-FHZVRMUW9FsXobt+ONiix6Z0tIkxvQfxtCSirkKc5Sb4TKHmqq1dZa8DphF0XqKb3ldLu/wgMa8mT6uXiLlRlw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="./assets/js/custom.js"></script>
    <script src="./assets/js/custom.menu.js"></script>

</body>
<script>
    var abiHelper = new $.ABI();
    var coreHelper = new $.Core();
    var configHelper = new $.CONFIG();
    var contractBaseHelper = new $.CONTRACTBASE();
    var storeHelper = new $.STORE();
    var dataHelper = new $.DATA();
    var garbiFarmHelper = new $.GARBI_FARM();
    var pid = 5;
    var chainId = 421613;
    $('.alert-banner').hide();
        if (typeof window.ethereum !== 'undefined') {
          const web3 = new Web3(window.ethereum);
          window.ethereum.enable();
          web3.eth.getChainId()
            .then(chainId => {
              if (chainId !== 42161) {
                $('.alert-banner').show();
              }
              else {
                $('.alert-banner').hide();
              }
            })
            .catch(error => {
              console.error(error);
            });
        } else {
          console.log("Metamask not found");
        }
    $(document).ready(function() {
        abiHelper.init({});
        coreHelper.init({});
        configHelper.init({});
        storeHelper.init({});
        contractBaseHelper.init({
            "chainId": chainId
        });
        dataHelper.init({
            "chainId": chainId
        });
        let NonfungiblePositionManagerABI = abiHelper.getNonfungiblePositionManagerABI();         
        let NonfungiblePositionManagerContract = contractBaseHelper.getReadContract(configHelper.getContractAddressByName(chainId, 'NonfungiblePositionManager'), NonfungiblePositionManagerABI);
        let GarbiFarmUniV3ABI = abiHelper.getGarbiFarmUniV3ABI();
        let userWallet = coreHelper.getUserAccount();
        let GarbiFarmUniV3Contract = contractBaseHelper.getReadContract(configHelper.getContractAddressByName(chainId, 'GarbiFarmUniV3'), GarbiFarmUniV3ABI);
        let userTokenId;
        let wethPrice;
        let grbPrice;
        $.get("https://api.coingecko.com/api/v3/simple/price?ids=garbi-protocol%2Cethereum&vs_currencies=usd", function(data) {
            wethPrice = data["ethereum"]["usd"];
            grbPrice = data["garbi-protocol"]["usd"];
        });
        GarbiFarmUniV3Contract.methods.getData(userWallet).call()
        .then(function (result) {
            let userTokenId = result.tokenId;
            if (userTokenId == 0) {  
                GarbiFarmUniV3Contract.methods.getNFTTokensWithPair(userWallet).call()
                .then(function (result) {      
                    userTokenId = result[result.length - 1];
                    GarbiFarmUniV3Contract.methods.getNFTTokenInfo(userTokenId).call()
                    .then (function (result) {
                        let UserToken2Amount = result.token0Amount / 10 ** 6;
                        $('.user-token-2-amount').text(UserToken2Amount.toFixed(2));
                        let UserToken1Amount = result.token1Amount / 10 ** 18;
                        $('.user-token-1-amount').text(UserToken1Amount.toFixed(2));
                        let VolumeLiquidity = UserToken2Amount * wethPrice + UserToken1Amount * grbPrice;
                        $('.liquidity-volume').text(VolumeLiquidity.toFixed(2));
                        if (result.inPriceRange == true) {
                            $('.notice-range').hide();
                        }
                        else {
                            $('.notice-range').show();
                        }
                        let dataUrlString = result.tokenURI;
                        let Base64DataUrl = dataUrlString.split(",")[1]
                        let DataUrl = JSON.parse(atob(Base64DataUrl));
                        $('.image-token').attr('src', DataUrl.image);
                    });
                    $('.grb-farm-2 .button-deposit-nft').click(function () {
                        NonfungiblePositionManagerContract.methods.getApproved(userTokenId).call().then(function (result) {
                            if (result == configHelper.getContractAddressByName(chainId, 'GarbiFarmUniV3')) {
                                $('#token-increase .btn-approve').hide();
                                $('#token-increase .btn-deposit').show();
                            }
                            else {
                                $('#token-increase .btn-approve').show();
                                $('#token-increase .btn-deposit').hide();               
                            }
                        });
                    });
                    $('#token-increase .btn-approve').click(function () {
                        let NonfungiblePositionManagerContract = contractBaseHelper.getMainContract(configHelper.getContractAddressByName(chainId, 'NonfungiblePositionManager'), NonfungiblePositionManagerABI);
                        NonfungiblePositionManagerContract.methods
                        .approve(
                            configHelper.getContractAddressByName(chainId, 'GarbiFarmUniV3')
                            ,userTokenId)
                        .send({
                            from: userWallet
                        })
                        .on('transactionHash', (hash) => {
                            coreHelper.showPopup('confirm-popup');
                            $('.transaction-hash').attr("href", "https://arbiscan.io/tx/" + hash);
                        })
                        .on('confirmation', (confirmationNumber, receipt) => {
                            $('#token-increase .btn-approve').hide();
                            $('#token-increase .btn-deposit').show();
                            coreHelper.hidePopup('confirm-popup', 0);
                            coreHelper.showPopup('success-confirm-popup');
                            coreHelper.hidePopup('success-confirm-popup', 10000);
                        })
                        .on('receipt', (receipt) => {
                            $('#token-increase .btn-approve').hide();
                            $('#token-increase .btn-deposit').show();
                            coreHelper.hidePopup('confirm-popup', 0);
                            coreHelper.showPopup('success-confirm-popup');
                            coreHelper.hidePopup('success-confirm-popup', 10000);
                        })
                        .on('error', (err, receipt) => {
                            console.log(err);
                        });
                    });
                    $('#token-increase .btn-deposit').click(function () {
                        let GarbiFarmUniV3Contract = contractBaseHelper.getMainContract(configHelper.getContractAddressByName(chainId, 'GarbiFarmUniV3'), GarbiFarmUniV3ABI);
                        GarbiFarmUniV3Contract.methods
                        .deposit(userTokenId)
                        .send({
                            from: userWallet
                        })
                        .on('transactionHash', (hash) => {
                            coreHelper.showPopup('confirm-popup');
                            $('.transaction-hash').attr("href", "https://arbiscan.io/tx/" + hash);
                        })
                        .on('confirmation', (confirmationNumber, receipt) => {
                            $('#token-increase').modal('hide');                     
                            $('.button-deposit-nft').addClass('button-disabled');
                            $('.button-withdraw').removeClass('button-disabled');
                            coreHelper.hidePopup('confirm-popup', 0);
                            coreHelper.showPopup('success-confirm-popup');
                            coreHelper.hidePopup('success-confirm-popup', 10000);
                        })
                        .on('receipt', (receipt) => {
                            $('#token-increase').modal('hide');
                            $('.button-deposit-nft').addClass('button-disabled');
                            $('.button-withdraw').removeClass('button-disabled');
                            coreHelper.hidePopup('confirm-popup', 0);
                            coreHelper.showPopup('success-confirm-popup');
                            coreHelper.hidePopup('success-confirm-popup', 10000);
                        })
                        .on('error', (err, receipt) => {
                            console.log(err);
                        });
                    });
                    $('.button-withdraw').click(function () {
                        if (!$(this).hasClass('button-disabled')) {
                            let GarbiFarmUniV3Contract = contractBaseHelper.getMainContract(configHelper.getContractAddressByName(chainId, 'GarbiFarmUniV3'), GarbiFarmUniV3ABI);
                            GarbiFarmUniV3Contract.methods.withdraw()
                            .send({
                                from: userWallet
                            })
                            .on('transactionHash', (hash) => {
                                coreHelper.showPopup('confirm-popup');
                                $('.transaction-hash').attr("href", "https://arbiscan.io/tx/" + hash);
                            })
                            .on('confirmation', (confirmationNumber, receipt) => {
                                $(this).addClass('button-disabled');
                                coreHelper.hidePopup('confirm-popup', 0);
                                coreHelper.showPopup('success-confirm-popup');
                                coreHelper.hidePopup('success-confirm-popup', 10000);
                            })
                            .on('receipt', (receipt) => {
                                $(this).addClass('button-disabled');
                                coreHelper.hidePopup('confirm-popup', 0);
                                coreHelper.showPopup('success-confirm-popup');
                                coreHelper.hidePopup('success-confirm-popup', 10000);
                            })
                            .on('error', (err, receipt) => {
                                console.log(err);
                            });
                        }
                        
                    });        
                });

            }
            else {
                $('.button-deposit-nft').addClass('button-disabled');
                let UserEarnToken = result.userGRBPending_ / 10 ** 18;
                $('.user-earn-token').text(UserEarnToken.toFixed(2));
                let EarnVolume = UserEarnToken * grbPrice;
                $('.earn-volume').text(EarnVolume.toFixed(2));
                GarbiFarmUniV3Contract.methods.getNFTTokenInfo(userTokenId).call()
                .then (function (result){
                    let UserToken2Amount = result.token0Amount / 10 ** 6;
                    $('.user-token-2-amount').text(UserToken2Amount.toFixed(2));
                    let UserToken1Amount = result.token1Amount / 10 ** 18;
                    $('.user-token-1-amount').text(UserToken1Amount.toFixed(2));
                    let VolumeLiquidity = UserToken2Amount * wethPrice + UserToken1Amount * grbPrice;
                    $('.liquidity-volume').text(VolumeLiquidity.toFixed(2));
                    if (result.inPriceRange == true) {
                        $('.notice-range').hide();
                    }
                    else {
                        $('.notice-range').show();
                    }
                    let dataUrlString = resultNFT.tokenURI;
                    let Base64DataUrl = dataUrlString.split(",")[1]
                    let DataUrl = JSON.parse(atob(Base64DataUrl));
                    $('.image-token').attr('src', DataUrl.image);
                });
            }

        });
        setInterval(function () {
            GarbiFarmUniV3Contract.methods.getData(userWallet).call()
            .then(function (result) {
                let userTokenId = result.tokenId;
                if (userTokenId == 0) {  
                    GarbiFarmUniV3Contract.methods.getNFTTokensWithPair(userWallet).call()
                    .then(function (result) {      
                        userTokenId = result[result.length - 1];
                        GarbiFarmUniV3Contract.methods.getNFTTokenInfo(userTokenId).call()
                        .then (function (result) {
                            let UserToken2Amount = result.token0Amount / 10 ** 6;
                            $('.user-token-2-amount').text(UserToken2Amount.toFixed(2));
                            let UserToken1Amount = result.token1Amount / 10 ** 18;
                            $('.user-token-1-amount').text(UserToken1Amount.toFixed(2));
                            let VolumeLiquidity = UserToken2Amount * wethPrice + UserToken1Amount * grbPrice;
                            $('.liquidity-volume').text(VolumeLiquidity.toFixed(2));
                            if (result.inPriceRange == true) {
                                $('.notice-range').hide();
                            }
                            else {
                                $('.notice-range').show();
                            }
                        });
                    });
                }
                else {
                    $('.button-withdraw').removeClass('button-disabled');
                    let UserEarnToken = result.userGRBPending_ / 10 ** 18;
                    $('.user-earn-token').text(UserEarnToken.toFixed(2));
                    let EarnVolume = UserEarnToken * grbPrice;
                    $('.earn-volume').text(EarnVolume.toFixed(2));
                    GarbiFarmUniV3Contract.methods.getNFTTokenInfo(userTokenId).call()
                    .then (function (result){
                        let UserToken2Amount = result.token0Amount / 10 ** 6;
                        $('.user-token-2-amount').text(UserToken2Amount.toFixed(2));
                        let UserToken1Amount = result.token1Amount / 10 ** 18;
                        $('.user-token-1-amount').text(UserToken1Amount.toFixed(2));
                        let VolumeLiquidity = UserToken2Amount * wethPrice + UserToken1Amount * grbPrice;
                        $('.liquidity-volume').text(VolumeLiquidity.toFixed(2));
                        if (result.inPriceRange == true) {
                            $('.notice-range').hide();
                        }
                        else {
                            $('.notice-range').show();
                        }
                    });
                }
            });
        }, 3000);
        $('.harvest-button').click(function () {
            let GarbiFarmUniV3Contract = contractBaseHelper.getMainContract(configHelper.getContractAddressByName(chainId, 'GarbiFarmUniV3'), GarbiFarmUniV3ABI);
            GarbiFarmUniV3Contract.methods
            .harvest(userWallet)
            .send({
                from: userWallet
            })
            .on('transactionHash', (hash) => {
                coreHelper.showPopup('confirm-popup');
                $('.transaction-hash').attr("href", "https://arbiscan.io/tx/" + hash);
            })
            .on('confirmation', (confirmationNumber, receipt) => {
                coreHelper.hidePopup('confirm-popup', 0);
                coreHelper.showPopup('success-confirm-popup');
                coreHelper.hidePopup('success-confirm-popup', 10000);
            })
            .on('receipt', (receipt) => {
                coreHelper.hidePopup('confirm-popup', 0);
                coreHelper.showPopup('success-confirm-popup');
                coreHelper.hidePopup('success-confirm-popup', 10000);
            })
            .on('error', (err, receipt) => {
                console.log(err);
            });
        });
    });
</script>

</html>